<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>Easy Batch &bull; Asynchronous jobs</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Mahmoud Ben Hassine">
    <meta name="description" content="open source lightweight batch processing framework for Java">
    <meta name="keyword" content="java, batch, batch processing, open source">

    <!-- Bootstrap CSS -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">

    <!-- Font Awesome -->
    <link href="../css/font-awesome.min.css" rel="stylesheet">

    <!-- Plugins -->
    <link href="../css/highlight/default.css" media="screen" rel="stylesheet" />
    <link href="../css/clingify/clingify.css" rel="stylesheet">

    <!-- Theme style -->
    <link href="../css/theme-style.min.css" rel="stylesheet">

    <!--Your custom colour override-->
    <link href="../css/colour-blue.css" id="colour-scheme" rel="stylesheet">

    <!-- Your custom override -->
    <link href="../css/custom-style.css" rel="stylesheet">

    <!-- HTML5 shiv & respond.js for IE6-8 support of HTML5 elements & media queries -->
    <!--[if lt IE 9]>
    <script src="../js/plugins/html5shiv/html5shiv.js"></script>
    <script src="../js/plugins/respond/respond.min.js"></script>
    <![endif]-->

    <link rel="shortcut icon" href="../img/misc/gear.ico">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700,300|Rambla|Calligraffitti' rel='stylesheet' type='text/css'>

    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-35599235-1']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

    </script>

</head>
<body class="page page-index-static">

<a href="#content" class="sr-only">Skip to content</a>
<div id="navigation" class="wrapper">
    <div class="navbar-static-top">

        <!--Header & Branding region-->
        <div class="header">
            <div class="header-inner container">
                <div class="row">
                    <div class="col-md-8">
                        <!--branding/logo-->
                        <a class="navbar-brand" href="../index.html" title="Home">
                            <h1><span>Easy</span>Batch</h1>
                        </a>
                        <div class="slogan">Batch processing with Java made easy</div>
                    </div>
                    <div class="col-md-4">
                        <!--social media icons-->
                        <div class="social-media">
                            <a href="https://github.com/benas/easy-batch" title="View on GitHub" target="_blank"><i class="fa fa-github"></i></a>
                            <a href="https://twitter.com/intent/tweet?url=http://www.easybatch.org/&text=Easy%20Batch:%20batch%20processing%20with%20Java%20made%20easy&via=md_benhassine" title="Share on Twitter" target="_blank"><i class="fa fa-twitter"></i></a>
                            <a href="https://plus.google.com/share?url=http://www.easybatch.org&text=Easy%20Batch:%20batch%20processing%20with%20Java%20made%20easy" title="Share on Google+" target="_blank"><i class="fa fa-google-plus"></i></a>
                            <a href="https://gitter.im/benas/easy-batch" title="Chat on Gitter" target="_blank"><i class="fa fa-comment"></i></a>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <div class="container" data-toggle="clingify">
            <div class="navbar">
                <!--
              mobile collapse menu button
              - data-toggle="toggle" = default BS menu
              - data-toggle="jpanel-menu" = jPanel Menu
              -->
                <a class="navbar-btn" data-toggle="jpanel-menu" data-target=".navbar-collapse"> <span class="bar"></span> <span class="bar"></span> <span class="bar"></span> <span class="bar"></span> </a>

                <!--user menu-->
                <div class="user-menu pull-right"> <a href="https://oss.sonatype.org/content/groups/public/org/easybatch/" title="Download Easy Batch from Maven central repository" class="btn btn-primary" target="_blank"><i class="fa fa-download"></i> version : 3.0.0</a> </div>

                <!--everything within this div is collapsed on mobile-->
                <div class="navbar-collapse collapse">

                    <!--main navigation-->
                    <ul class="nav navbar-nav">
                        <li><a href="../index.html"><i class="fa fa-home fa-lg"></i> Home</a></li>
                        <li class="dropdown"> <a href="#" class="dropdown-toggle menu-item" id="features-drop" data-toggle="dropdown"><i class="fa fa-book fa-lg" ></i> Documentation +</a>
                            <ul class="dropdown-menu" role="menu" aria-labelledby="about-drop">
                                <li role="presentation"><a role="menuitem" href="../documentation/getting-started.html" class="menu-item"><i class="fa fa-play fa-lg"></i> Getting started</a></li>
                                <li role="presentation"><a role="menuitem" href="../documentation/architecture.html" tabindex="-1" class="menu-item"><i class="fa fa-flask fa-lg"></i> Architecture</a></li>
                                <li role="presentation"><a role="menuitem" href="../documentation/user-guide.html" tabindex="-1" class="menu-item"><i class="fa fa-book fa-lg"></i> User guide</a></li>
                                <li role="presentation"><a role="menuitem" href="../api/index.html" tabindex="-1" class="menu-item" target="_blank"><i class="fa fa-folder-open fa-lg"></i> API docs</a></li>
                                <li role="presentation"><a role="menuitem" href="../documentation/faq.html" tabindex="-1" class="menu-item"><i class="fa fa-question-circle fa-lg"></i> FAQs</a></li>
                                <li role="presentation"><a role="menuitem" href="https://speakerdeck.com/benas/easy-batch" target="_blank" tabindex="-1" class="menu-item"><i class="fa fa-video-camera fa-lg"></i> Presentation slides</a></li>
                            </ul>
                        </li>
                        <li><a href="../tutorials/index.html" class="menu-item"><i class="fa fa-code fa-lg"></i> Tutorials</a></li>
                        <li class="dropdown"> <a href="" class="dropdown-toggle" id="about-drop" data-toggle="dropdown"><i class="fa fa-thumbs-o-up fa-lg"></i> Get involved +</a>
                            <ul class="dropdown-menu" role="menu" aria-labelledby="about-drop">
                                <li role="presentation"><a role="menuitem" href="https://github.com/benas/easy-batch" target="_blank" tabindex="-1" class="menu-item"><i class="fa fa-github fa-lg"></i> Source repository</a></li>
                                <li role="presentation"><a role="menuitem" href="https://github.com/benas/easy-batch/issues" target="_blank" tabindex="-1" class="menu-item"><i class="fa fa-bug fa-lg"></i> Issue tracker</a></li>
                            </ul>
                        </li>

                    </ul>
                </div>
                <!--/.navbar-collapse -->
            </div>
        </div>
    </div>
</div>

<div id="content">
    <div class="container">

        <!-- breadcrumb -->
<ul class="breadcrumb">
    <li><a href="../index.html">Home</a></li>
    
    <li><a href="../tutorials/index.html">Tutorials</a></li>
    
    
    <li class="active">Asynchronous jobs</li>
</ul>

        <div class="row">
            <div class="col-md-9">

                <h1 class="title-divider"><span>Asynchronous jobs</span></h1>

                              <h2>1. Introduction</h2>

              <p>In this tutorial, you will learn how process data asynchronously using Easy Batch and JMS.</p>
        <p>Suppose you have a stream of tweets that you would like to process asynchronously using a JMS queue:</p>


<div class="row">
    <div class="col-md-10 col-md-offset-1">
        <p class="pull-center"><img class="ebi" src="../img/eb/jms.jpg"/></p>
    </div>
</div>

        <p>Easy Batch provides the <code><em>JmsQueueRecordReader</em></code> that is able to read data from a JMS queue.</p>

        <p>Let's get started.</p>

<h2>2. What youâ€™ll need</h2>

<ul>
    <li>JDK 1.6+</li>
    <li>Maven</li>
    <li>Git (Optional)</li>
    <li>Your favorite IDE (Optional)</li>
</ul>

        <h2>3. Reading tweets from JMS queue</h2>

        <p>The <code><em>JmsQueueRecordReader</em></code> needs to be configured with the JMS queue connection factory and the queue to read data from. It will produce <code><em>JmsRecord</em></code> instances with a <code><em>javax.jms.Message</em></code> as payload.</p>

        <div class="bs-callout bs-callout-code">
<pre><code class="java">Engine engine = new EngineBuilder()
    .reader(new JmsRecordReader(JMSUtil.queueConnectionFactory, JMSUtil.queue))
    .build();
</code></pre>
        </div>

        <p>The <code><em>JMSUtil</em></code> class is used to start an embedded broker and to provide JMS utilities.
            The broker setup details are not shown here for readability's sake.</p>

        <h2>4. Processing tweets</h2>

        <p>To process <code><em>JmsRecord</em></code> instances, you will use the following <code><em>RecordProcessor</em></code>:</p>

        <div class="bs-callout bs-callout-code">
            <h5>JmsRecordProcessor.java</h5>
<pre><code class="java">public class JmsRecordProcessor implements RecordProcessor&lt;JmsRecord, JmsRecord&gt; {

    @Override
    public JmsRecord processRecord(JmsRecord record) throws Exception {
        TextMessage message = (TextMessage) record.getPayload();
        System.out.println("JMS message '" + message.getText() + "' processed");
        return record;
    }
}
</code></pre>
        </div>

        <p>This processor will extract the message payload and print it out to the console.</p>

        <h2>5. Putting it all together</h2>

        <p>To launch the tutorial, you will use the following class:</p>

        <div class="bs-callout bs-callout-code">
<pre><code class="java">public class Launcher {

    public static void main(String[] args) throws Exception {

        JMSUtil.startEmbeddedBroker();

        JMSUtil.initJMSFactory();

        // Build easy batch engines
        Engine engine = new EngineBuilder()
            .reader(new JmsRecordReader(JMSUtil.queueConnectionFactory, JMSUtil.queue))
            .filter(new JmsPoisonRecordFilter())
            .processor(new JmsRecordProcessor())
            .build();

        //run engine and get report
        Report report = engine.call();

        System.out.println(report);

        JMSUtil.stopEmbeddedBroker();

    }

}</code></pre>
        </div>
        <p>This class will start an embedded JMS Broker to listen to incoming tweets.</p>

       <p>In order to send tweets as JMS messages to the queue,
           you will use the following utility class:</p>

        <div class="bs-callout bs-callout-code">
<pre><code class="java">public class JMSSenderLauncher {

    public static void main(String[] args) throws Exception {

        //init JMS factory
        JMSUtil.initJMSFactory();

        // Send some messages to JMS queue
        Scanner scanner = new Scanner(System.in);
        String input;
        do {
            input = scanner.nextLine();
            JMSUtil.sendStringRecord(input);
        } while (!input.equalsIgnoreCase("quit"));

        //send a poison record at the end to stop the engine
        JMSUtil.sendPoisonRecord();
        System.exit(0);
    }
}</code></pre>
        </div>

<p>The <code><em>JMSSenderLauncher</em></code> class makes the tutorial interactive: you will be able to send tweets to the queue by typing in tweets in the console.
    To stop the execution, you have to type in <em>quit</em> in the console. This will send a poison record to the queue which will cause the engine to stop execution.</p>

<div class="bs-callout bs-callout-warning">
    <h5><i class="fa fa-info-circle"></i> Heads up!</h5>
    <p>Poison records serve as End-Of-Stream messages, they are used to stop the engine (gracefully).
        Easy Batch provides the <code><em>JmsPoisonMessage</em></code> to stop the engine whenever it receives a message of this type.
        Poison records have no business value,  filter them using the built-in <code><em>JmsPoisonRecordFilter</em></code>.</p>
</div>

              <p>That's all, you can now run the tutorial and see the results.</p>

              <h2>6. Running the tutorial</h2>

        <h3>6.1 From the command line</h3>

<p>To run the tutorial, proceed as follow:</p>
<div class="bs-callout bs-callout-code">
<pre><code>$>git clone https://github.com/benas/easy-batch.git
$>cd easy-batch
$>mvn install
$>cd easybatch-tutorials
$>mvn exec:java -PrunJmsTutorial
</code></pre>
</div>

        <p>This will start an embedded JMS broker listening to incoming messages.</p>

        <p>To start the message sender class, fire up a second terminal and run the following command:</p>
<div class="bs-callout bs-callout-code">
<pre><code>$>mvn exec:java -PrunJmsSender
</code></pre>
</div>

              <p>You will be able to type in tweets in the console to post them to the JMS queue and see how the engine will process them as they come. Here is a sample output:</p>

              <div class="row">
                  <div class="col-md-6">
                      <div class="bs-callout bs-callout-code">
<pre><code>1,foo,easy batch rocks! #EasyBatch
Message '1,foo,easy batch rocks! #EasyBatch' sent to JMS queue
2,bar,@foo I do confirm :-)
Message '2,bar,@foo I do confirm :-)' sent to JMS queue
quit
Message 'quit' sent to JMS queue

</code></pre>
                  </div>
              </div>

<div class="col-md-6">

                      <div class="bs-callout bs-callout-code">
<pre><code>INFO: Initializing easy batch engine
INFO: Data source: JMS queue: q
INFO: Strict mode: false
INFO: Total records = N/A
INFO: easy batch engine is running...
JMS message '1,foo,easy batch rocks! #EasyBatch' processed
JMS message '2,bar,@foo I do confirm :-)' processed</code></pre>
                  </div>
                  </div>

              </div>

<h3>6.2 From your IDE</h3>

<p>First, you need to checkout the source code of the tutorial available <a href="https://github.com/benas/easy-batch/tree/master/easybatch-tutorials/src/main/java/org/easybatch/tutorials/advanced/spring" target="_blank">here</a>:</p>

<div class="bs-callout bs-callout-code">
    <pre><code>$>git clone https://github.com/benas/easy-batch.git</code></pre>
</div>

<p>If you do not have git installed, you can download a zip file containing the project's source code from GitHub
    <a href="https://github.com/benas/easy-batch/archive/easybatch-3.0.0.zip">here</a>.</p>

<p>Then, import the <code><em>easybatch-tutorials</em></code> module in you favorite IDE and resolve maven dependencies.</p>

<p>Finally, run the following classes separately without any argument:</p>

<ul>
    <li><code><em>org.easybatch.tutorials.advanced.jms.Launcher</em></code> to launch the batch engine</li>
    <li><code><em>org.easybatch.tutorials.advanced.jms.JMSSenderLauncher</em></code> to launch the message sender</li>
    <li></li>
</ul>

              <h2>7. Summary</h2>

              <p> In this tutorial, you have learned how to use Easy Batch along with JMS to create an asynchronous batch application.</p>
              <p>As you have seen in the <a href="./parallel.html">Parallel jobs tutorial</a>, you can also distribute the work across multiple Easy Batch worker instances.</p>

        <div class="bs-callout bs-callout-success">
            <p><i class="fa fa-info-circle"></i> When combined together, asynchronous and parallel processing provide an <strong>extremely powerful</strong> technique of data processing! Easy Batch makes it a breeze <i class="fa fa-smile-o"></i></p>
        </div>

<h2>8. What's next?</h2>

<p>In the next tutorial, you will go a step further, by balancing the workload to an army of worker engines distributed
across a cluster of machines.</p>

<nav>
    <ul class="pager">
        <li class="previous"><a href="./parallel.html"><span aria-hidden="true">&larr;</span> Parallel jobs</a></li>
        <li class="next"><a href="./distributed.html">Distributed jobs tutorial<span aria-hidden="true">&rarr;</span></a></li>
    </ul>
</nav>

            </div>

            <div class="col-md-3 sidebar-right">
                <!-- <div class="inner" data-spy="affix" data-offset-top="40" data-offset-bottom="300"> -->
<div class="inner">
<ul class="list-lg">
    <li class="sidebar-separator">About Easy Batch</li>
    <li >
        <a href="../index.html">Overview</a>
    </li>
    <li >
        <a href="../release-notes.html">Release notes</a>
    </li>
    <li class="sidebar-separator">Documentation</li>
    <li >
        <a href="../documentation/getting-started.html">Getting started</a>
    </li>
    <li >
        <a href="../documentation/architecture.html">Architecture</a>
    </li>
    <li >
        <a href="../documentation/user-guide.html">User guide</a>
    </li>
    <li  class="active" >
        <a href="../tutorials/index.html">Tutorials</a>
    </li>
    <li>
        <a href="../api/index.html" target="_blank">API docs</a>
    </li>
    <li >
        <a href="../documentation/faq.html">FAQs</a>
    </li>
    <li>
        <a href="https://speakerdeck.com/benas/easy-batch" target="_blank">Presentation slides</a>
    </li>
    <li class="sidebar-separator">Get involved</li>
    <li>
        <a href="https://github.com/benas/easy-batch" target="_blank">Source repository</a>
    </li>
    <li>
        <a href="https://github.com/benas/easy-batch/issues" target="_blank">Issue tracker</a>
    </li>
</ul>
</div>
            </div>
        </div>


    </div>
</div>
<!-- FOOTER -->
<footer id="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-3 col">
                <div class="block contact-block">
                    <h3>Documentation</h3>
                    <ul class="fa-ul">
                        <li><a href="../documentation/getting-started.html"><i class="fa fa-li fa-play"></i> Getting started</a></li>
                        <li><a href="../documentation/architecture.html"><i class="fa fa-li fa-flask"></i> Architecture</a></li>
                        <li><a href="../documentation/user-guide.html"><i class="fa fa-li fa-book"></i> User guide</a></li>
                    </ul>
                </div>
            </div>
            <div class="col-md-3 col">
                <div class="block contact-block">
                    <h3>Tutorials</h3>
                    <ul class="fa-ul">
                    <li><a href="../tutorials/index.html#basic"><i class="fa fa-li fa-star-o"></i> Basic tutorials</a></li>
                        <li><a href="../tutorials/index.html#intermediate"><i class="fa fa-li fa-star-half-o"></i> Intermediate tutorials</a></li>
                        <li><a href="../tutorials/index.html#advanced"><i class="fa fa-li fa-star"></i> Advanced Tutorials</a></li>
                    </ul>
                </div>
            </div>
            <div class="col-md-3 col">
                <div class="block contact-block">
                    <h3>Get involved</h3>
                    <ul class="fa-ul">
                        <li><a href="https://github.com/benas/easy-batch" target="_blank"><i class="fa fa-li fa-github"></i> Source repository</a></a></li>
                        <li><a href="https://github.com/benas/easy-batch/issues" target="_blank"><i class="fa fa-li fa-bug"></i> Issue tracker</a></li>
                        <li><a href="../documentation/faq.html"><i class="fa fa-li fa-question"></i> FAQs</a></li>
                    </ul>
                </div>
            </div>
            <div class="col-md-3 col">
                <div class="block contact-block">
                    <h3>Become a friend</h3>
                    <ul class="fa-ul">
                        <li><a href="https://twitter.com/intent/tweet?url=http://www.easybatch.org/&text=Easy%20Batch:%20batch%20processing%20with%20Java%20made%20easy&via=md_benhassine" target="_blank"><i class="fa fa-li fa-twitter"></i> Share it on Twitter</a></a></li>
                        <li><a href="https://plus.google.com/share?url=http://www.easybatch.org&text=Easy%20Batch:%20batch%20processing%20with%20Java%20made%20easy" target="_blank"><i class="fa fa-li fa-google-plus"></i> Share it on Google+</a></a></li>
                        <li><a href="https://github.com/benas/easy-batch" target="_blank"><i class="fa fa-li fa-heart"></i> Star it on GitHub</a></li>
                    </ul>
                </div>
            </div>

        </div>

        <br>
        <p class="back-top floatright" style="display: none;">
            <a href="#top"><span></span></a>
        </p>

        <div class="row">
            <div id="toplink"><a href="#top" class="top-link" title="Back to top">Back To Top <i class="fa fa-chevron-up"></i></a></div>

            <div class="subfooter">
                <br>
                <div class="col-md-4">
                    <p>&copy; Easy Batch is created by <a href="http://www.mahmoud-benhassine.fr" target="_blank">Mahmoud Ben Hassine</a> <br>
                    and the <a href="https://github.com/benas/easy-batch#awesome-contributors" target="_blank">awesome contributors</a></p>
                </div>
                <div class="col-md-4 text-center">
                    <iframe src="http://ghbtns.com/github-btn.html?user=benas&repo=easy-batch&type=watch&count=true"
                            allowtransparency="true" frameborder="0" scrolling="0" width="110" height="20"></iframe>
                    <iframe src="http://ghbtns.com/github-btn.html?user=benas&repo=easy-batch&type=fork&count=true"
                            allowtransparency="true" frameborder="0" scrolling="0" width="95" height="20"></iframe>
                </div>
                <div class="col-md-4">
                    <p class="footer-menu">Easy Batch is open source and is released <br> under the terms of the <a href="http://opensource.org/licenses/mit-license.php/" target="_blank">MIT license</a>.</p>
                </div>
            </div>
        </div>
    </div>
</footer>

<!--Scripts -->
<script src="../js/jquery.min.js"></script>
<script src="../js/jquery-migrate-1.2.1.min.js"></script> <!--Legacy jQuery support for quicksand plugin-->

<!-- Bootstrap JS -->
<script src="../js/bootstrap.min.js"></script>

<!--JS plugins-->
<script src="../js/plugins/clingify/jquery.clingify.min.js"></script>
<script src="../js/plugins/jRespond/jRespond.js"></script>

<!--Custom scripts mainly used to trigger libraries -->
<script src="../js/script.min.js"></script>
<script src="../js/scrolltotop.js"></script>
<script src="../js/homeScroll.js"></script>
<script src="../js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>